import{_ as _e,u as be,f as ge,r as n,w as ye,g as we,o as $e,h as u,i as A,b as P,c as x,j as a,e as o,k as r,t as d,l as R,m as Ve,F as ke,a as b,n as Ce,p as Q,q as W,s as Se,v as De}from"./index-78f5fb40.js";const H=V=>(Se("data-v-621d9499"),V=V(),De(),V),Pe={class:"grid"},Re={class:"col-12"},Te={class:"card p-4 shadow-2 border-round"},Le={class:"text-2xl font-bold"},Ie={class:"flex gap-2"},Ue={class:"p-fluid p-4 mb-4 surface-100 border-round"},xe={class:"grid"},Fe={class:"col-12 md:col-3"},Ne={for:"search"},Ee={class:"col-12 md:col-3"},Me={for:"governorate"},Be={class:"col-12 md:col-3"},qe={for:"status"},Oe={class:"col-12 md:col-3"},je={for:"dateRange"},Ge={class:"col-12 flex justify-content-end mt-3"},ze=H(()=>a("div",{class:"text-center py-4"},[a("i",{class:"pi pi-exclamation-circle text-2xl mb-2"}),a("p",{class:"text-xl"},"No roles found")],-1)),Ae={class:"flex justify-content-center align-items-center py-4"},Qe={class:"font-medium"},We={class:"font-medium"},He={class:"flex gap-2"},Je={class:"p-fluid"},Ke={class:"field mb-4"},Xe={for:"name"},Ye={key:0,class:"p-error"},Ze={class:"field"},el={class:"p-fluid"},ll={class:"field mb-4"},tl={for:"name"},al={key:0,class:"p-error"},ol={class:"field"},sl={class:"flex align-items-center justify-content-center"},nl=H(()=>a("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem",color:"var(--red-500)"}},null,-1)),il={setup(V){be();const p=ge(),k=n(!0),i=n({name:"",permissions:[]}),C=n([]),T=n([]),g=n(!1),y=n(!1),w=n(!1),F=n(null),N=n(null),E=n({}),c=n(!1),M=n(null),$=n(""),B=n([]),J=n([{id:"0",name:"Inactive"},{id:"1",name:"Active"}]),h=n(null),f=n(null),v=n(null),S=n(1),q=n(0),L=n(10),K=n(0),X=()=>{E.value={global:{value:null,matchMode:ke.CONTAINS}}},Y=()=>{const e={search:$.value,filters:[]};if(h.value&&e.filters.push({id:"governorate_id",value:h.value.id}),f.value&&e.filters.push({id:"status",value:f.value.id}),v.value&&v.value.length===2){const[l,s]=v.value;e.filters.push({id:"created_at",value:l.toISOString().split("T")[0],expression:"GreaterThanOrEqual"}),e.filters.push({id:"created_at",value:s.toISOString().split("T")[0],expression:"LessThanOrEqual"})}return e},m=()=>{k.value=!0;const e=Y();b.get("/api/roles",{params:{page:S.value,per_page:L.value,...e}}).then(l=>{C.value=l.data.data,q.value=l.data.meta.total,K.value=l.data.meta.last_page,k.value=!1}).catch(l=>{k.value=!1,p.add({severity:"error",summary:"Error",detail:"Failed to load roles",life:3e3})})},Z=()=>{b.get("/api/Lookup/CountryList").then(e=>{B.value=e.data.data}).catch(e=>{console.error("Error fetching governorates:",e)})},ee=()=>{b.get("/api/permissions").then(e=>{T.value=e.data.data}).catch(e=>{console.error("Error fetching permissions:",e)})},le=()=>{$.value="",h.value=null,f.value=null,v.value=null,S.value=1,m()},te=e=>{S.value=e.page+1,L.value=e.rows,m()};ye([$,h,f,v],()=>{S.value=1,m()},{deep:!0});const ae=()=>{i.value={name:"",permissions:[]},c.value=!1,y.value=!0},O=()=>{y.value=!1,w.value=!1,c.value=!1},oe=()=>{c.value=!0,b.post("/api/roles",i.value).then(()=>{m(),y.value=!1,p.add({severity:"success",summary:"Successful",detail:"Role created successfully",life:3e3})}).catch(e=>{var l,s;p.add({severity:"error",summary:"Error",detail:((s=(l=e.response)==null?void 0:l.data)==null?void 0:s.message)||"Failed to create role",life:3e3})})},se=e=>{i.value={...e},w.value=!0},ne=()=>{c.value=!0,b.put(`/api/roles/${i.value.id}`,i.value).then(()=>{m(),w.value=!1,p.add({severity:"success",summary:"Successful",detail:"Role updated successfully",life:3e3})}).catch(e=>{var l,s;p.add({severity:"error",summary:"Error",detail:((s=(l=e.response)==null?void 0:l.data)==null?void 0:s.message)||"Failed to update role",life:3e3})})},ie=e=>{M.value=e,g.value=!0},re=()=>{b.delete(`/api/roles/${M.value}`).then(()=>{m(),g.value=!1,p.add({severity:"success",summary:"Successful",detail:"Role deleted successfully",life:3e3})}).catch(e=>{var l,s;p.add({severity:"error",summary:"Error",detail:((s=(l=e.response)==null?void 0:l.data)==null?void 0:s.message)||"Failed to delete role",life:3e3})})},de=()=>{N.value.exportCSV()};return we(()=>{X()}),$e(()=>{m(),ee(),Z()}),(e,l)=>{const s=u("Button"),ue=u("Toolbar"),I=u("InputText"),j=u("Dropdown"),ce=u("Calendar"),pe=u("Toast"),ve=u("ProgressSpinner"),_=u("Column"),me=u("Tag"),he=u("DataTable"),G=u("MultiSelect"),U=u("Dialog"),D=A("can"),z=A("tooltip");return P(),x("div",Pe,[a("div",Re,[a("div",Te,[o(ue,{class:"mb-4"},{start:r(()=>[a("h2",Le,d(e.$t("role.manage_roles")),1)]),end:r(()=>[a("div",Ie,[R(o(s,{label:e.$t("role.new_role"),icon:"pi pi-plus",class:"p-button-success",onClick:ae},null,8,["label"]),[[D,"create roles"]]),o(s,{label:e.$t("export"),icon:"pi pi-download",class:"p-button-help",onClick:de,disabled:!C.value||C.value.length===0},null,8,["label","disabled"])])]),_:1}),a("div",Ue,[a("div",xe,[a("div",Fe,[a("label",Ne,d(e.$t("search")),1),o(I,{id:"search",modelValue:$.value,"onUpdate:modelValue":l[0]||(l[0]=t=>$.value=t),placeholder:e.$t("search_placeholder"),class:"w-full"},null,8,["modelValue","placeholder"])]),a("div",Ee,[a("label",Me,d(e.$t("governorate")),1),o(j,{id:"governorate",modelValue:h.value,"onUpdate:modelValue":l[1]||(l[1]=t=>h.value=t),options:B.value,optionLabel:"name",optionValue:"id",placeholder:e.$t("select_governorate"),class:"w-full",showClear:!0},null,8,["modelValue","options","placeholder"])]),a("div",Be,[a("label",qe,d(e.$t("status")),1),o(j,{id:"status",modelValue:f.value,"onUpdate:modelValue":l[2]||(l[2]=t=>f.value=t),options:J.value,optionLabel:"name",optionValue:"id",placeholder:e.$t("select_status"),class:"w-full",showClear:!0},null,8,["modelValue","options","placeholder"])]),a("div",Oe,[a("label",je,d(e.$t("date_range")),1),o(ce,{id:"dateRange",modelValue:v.value,"onUpdate:modelValue":l[3]||(l[3]=t=>v.value=t),selectionMode:"range",manualInput:!1,dateFormat:"yy-mm-dd",showIcon:!0,showButtonBar:!0,class:"w-full",placeholder:e.$t("select_date_range")},null,8,["modelValue","placeholder"])]),a("div",Ge,[o(s,{label:e.$t("reset_filters"),icon:"pi pi-filter-slash",class:"p-button-outlined p-button-secondary",onClick:le},null,8,["label"])])])]),o(pe),R((P(),Ve(he,{ref_key:"dt",ref:N,selection:F.value,"onUpdate:selection":l[4]||(l[4]=t=>F.value=t),value:C.value,loading:k.value,"data-key":"id",paginator:!0,rows:L.value,totalRecords:q.value,filters:E.value,"paginator-template":"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown","rows-per-page-options":[5,10,25,50],"current-page-report-template":"Showing {first} to {last} of {totalRecords} entries","responsive-layout":"scroll",stripedRows:"",showGridlines:"",class:"p-datatable-sm",onPage:te},{empty:r(()=>[ze]),loading:r(()=>[a("div",Ae,[o(ve,{style:{width:"50px",height:"50px"},strokeWidth:"4"})])]),default:r(()=>[o(_,{"selection-mode":"multiple","header-style":"width: 3rem"}),o(_,{field:"id",header:e.$t("role.id"),sortable:!0,"header-style":"width:10%; min-width:5rem;"},{body:r(t=>[a("span",Qe,d(t.data.id),1)]),_:1},8,["header"]),o(_,{field:"name",header:e.$t("role.name"),sortable:!0,"header-style":"width:20%; min-width:10rem;"},{body:r(t=>[a("span",We,d(t.data.name),1)]),_:1},8,["header"]),o(_,{field:"permissions_count",header:e.$t("role.permissions"),sortable:!0,"header-style":"width:15%;"},{body:r(t=>[o(me,{value:t.data.permissions_count,severity:"info"},null,8,["value"])]),_:1},8,["header"]),o(_,{field:"created_at",header:e.$t("created_at"),sortable:!0,"header-style":"width:15%;"},{body:r(t=>[Ce(d(new Date(t.data.created_at).toLocaleDateString()),1)]),_:1},8,["header"]),o(_,{"header-style":"width:15%; min-width:10rem;",header:e.$t("actions")},{body:r(t=>[a("div",He,[R(o(s,{icon:"pi pi-pencil",class:"p-button-rounded p-button-success p-button-sm",onClick:fe=>se(t.data)},null,8,["onClick"]),[[D,"edit roles"],[z,"Edit",void 0,{top:!0}]]),R(o(s,{icon:"pi pi-trash",class:"p-button-rounded p-button-danger p-button-sm",onClick:fe=>ie(t.data.id)},null,8,["onClick"]),[[D,"delete roles"],[z,"Delete",void 0,{top:!0}]])])]),_:1},8,["header"])]),_:1},8,["selection","value","loading","rows","totalRecords","filters"])),[[D,"list roles"]]),o(U,{visible:y.value,"onUpdate:visible":l[7]||(l[7]=t=>y.value=t),style:{width:"450px"},header:e.$t("role.create_role"),modal:!0},{footer:r(()=>[o(s,{label:e.$t("cancel"),icon:"pi pi-times",class:"p-button-text",onClick:O},null,8,["label"]),o(s,{label:e.$t("save"),icon:"pi pi-check",class:"p-button-text",onClick:oe},null,8,["label"])]),default:r(()=>[a("div",Je,[a("div",Ke,[a("label",Xe,d(e.$t("role.name")),1),o(I,{id:"name",modelValue:i.value.name,"onUpdate:modelValue":l[5]||(l[5]=t=>i.value.name=t),modelModifiers:{trim:!0},required:"true",autofocus:"",class:Q([{"p-invalid":c.value&&!i.value.name},"w-full"])},null,8,["modelValue","class"]),c.value&&!i.value.name?(P(),x("small",Ye,"Name is required.")):W("",!0)]),a("div",Ze,[a("label",null,d(e.$t("role.permissions")),1),o(G,{modelValue:i.value.permissions,"onUpdate:modelValue":l[6]||(l[6]=t=>i.value.permissions=t),options:T.value,optionLabel:"name",optionValue:"id",placeholder:"Select Permissions",display:"chip",class:"w-full"},null,8,["modelValue","options"])])])]),_:1},8,["visible","header"]),o(U,{visible:w.value,"onUpdate:visible":l[10]||(l[10]=t=>w.value=t),style:{width:"450px"},header:e.$t("role.update_role"),modal:!0},{footer:r(()=>[o(s,{label:e.$t("cancel"),icon:"pi pi-times",class:"p-button-text",onClick:O},null,8,["label"]),o(s,{label:e.$t("update"),icon:"pi pi-check",class:"p-button-text",onClick:ne},null,8,["label"])]),default:r(()=>[a("div",el,[a("div",ll,[a("label",tl,d(e.$t("role.name")),1),o(I,{id:"name",modelValue:i.value.name,"onUpdate:modelValue":l[8]||(l[8]=t=>i.value.name=t),modelModifiers:{trim:!0},required:"true",autofocus:"",class:Q([{"p-invalid":c.value&&!i.value.name},"w-full"])},null,8,["modelValue","class"]),c.value&&!i.value.name?(P(),x("small",al,"Name is required.")):W("",!0)]),a("div",ol,[a("label",null,d(e.$t("role.permissions")),1),o(G,{modelValue:i.value.permissions,"onUpdate:modelValue":l[9]||(l[9]=t=>i.value.permissions=t),options:T.value,optionLabel:"name",optionValue:"id",placeholder:"Select Permissions",display:"chip",class:"w-full"},null,8,["modelValue","options"])])])]),_:1},8,["visible","header"]),o(U,{visible:g.value,"onUpdate:visible":l[12]||(l[12]=t=>g.value=t),style:{width:"450px"},header:e.$t("confirm"),modal:!0},{footer:r(()=>[o(s,{label:e.$t("no"),icon:"pi pi-times",class:"p-button-text",onClick:l[11]||(l[11]=t=>g.value=!1)},null,8,["label"]),o(s,{label:e.$t("yes"),icon:"pi pi-check",class:"p-button-text p-button-danger",onClick:re},null,8,["label"])]),default:r(()=>[a("div",sl,[nl,a("span",null,d(e.$t("role.delete_confirmation")),1)])]),_:1},8,["visible","header"])])])])}}},dl=_e(il,[["__scopeId","data-v-621d9499"]]);export{dl as default};
